      SUBROUTINE TIF107(PF107,INVDP,C,SEZA,SEZB,
     &                  ASOL,BSOL,ASOL2,BSOL2,CSOL2,  
     &                  TP350A,TP350B,TP430A,TP430B,
     &                  TP600A,TP600B,TP850A,TP850B)
      REAL PF107,INVDP
      REAL C(82)
      INTEGER SEZA,SEZB
      REAL ASOL(4,3,81),BSOL(4,3,81)
      REAL ASOL2(4,3,81),BSOL2(4,3,81),CSOL2(4,3,81)
      REAL        AL350A,AL350B,AL430A,AL430B,AL600A,AL600B,
     &            AL850A,AL850B
      REAL        BL350A,BL350B,BL430A,BL430B,BL600A,BL600B,
     &            BL850A,BL850B
      REAL        AQ350A,AQ350B,AQ430A,AQ430B,AQ600A,AQ600B,
     &            AQ850A,AQ850B
      REAL        BQ350A,BQ350B,BQ430A,BQ430B,BQ600A,BQ600B,
     &            BQ850A,BQ850B
      REAL        CQ350A,CQ350B,CQ430A,CQ430B,CQ600A,CQ600B,
     &            CQ850A,CQ850B       
      REAL        TP350A,TP350B,TP430A,TP430B,TP600A,TP600B,
     &            TP850A,TP850B
C     linear perturbation AL, BL
      AL350A=0.0
      AL350B=0.0
      AL430A=0.0
      AL430B=0.0
      AL600A=0.0
      AL600B=0.0
      AL850A=0.0
      AL850B=0.0
C      
      BL350A=0.0
      BL350B=0.0
      BL430A=0.0
      BL430B=0.0
      BL600A=0.0
      BL600B=0.0
      BL850A=0.0
      BL850B=0.0
C     second order perturbation AQ, BQ, CQ
      AQ350A=0.0
      AQ350B=0.0
      AQ430A=0.0
      AQ430B=0.0
      AQ600A=0.0
      AQ600B=0.0
      AQ850A=0.0
      AQ850B=0.0
C      
      BQ350A=0.0
      BQ350B=0.0
      BQ430A=0.0
      BQ430B=0.0
      BQ600A=0.0
      BQ600B=0.0
      BQ850A=0.0
      BQ850B=0.0
C      
      CQ350A=0.0
      CQ350B=0.0
      CQ430A=0.0
      CQ430B=0.0
      CQ600A=0.0
      CQ600B=0.0
      CQ850A=0.0
      CQ850B=0.0
C      
      DO 30 I=1,81
       AL350A=AL350A+C(I)*ASOL(1,SEZA,I)
       AL350B=AL350B+C(I)*ASOL(1,SEZB,I)
       AL430A=AL430A+C(I)*ASOL(2,SEZA,I)
       AL430B=AL430B+C(I)*ASOL(2,SEZB,I)
       AL600A=AL600A+C(I)*ASOL(3,SEZA,I)
       AL600B=AL600B+C(I)*ASOL(3,SEZB,I)
       AL850A=AL850A+C(I)*ASOL(4,SEZA,I)
       AL850B=AL850B+C(I)*ASOL(4,SEZB,I)
C       
       BL350A=BL350A+C(I)*BSOL(1,SEZA,I)
       BL350B=BL350B+C(I)*BSOL(1,SEZB,I)
       BL430A=BL430A+C(I)*BSOL(2,SEZA,I)
       BL430B=BL430B+C(I)*BSOL(2,SEZB,I)
       BL600A=BL600A+C(I)*BSOL(3,SEZA,I)
       BL600B=BL600B+C(I)*BSOL(3,SEZB,I)
       BL850A=BL850A+C(I)*BSOL(4,SEZA,I)
       BL850B=BL850B+C(I)*BSOL(4,SEZB,I)
C       
       AQ350A=AQ350A+C(I)*ASOL2(1,SEZA,I)
       AQ350B=AQ350B+C(I)*ASOL2(1,SEZB,I)
       AQ430A=AQ430A+C(I)*ASOL2(2,SEZA,I)
       AQ430B=AQ430B+C(I)*ASOL2(2,SEZB,I)
       AQ600A=AQ600A+C(I)*ASOL2(3,SEZA,I)
       AQ600B=AQ600B+C(I)*ASOL2(3,SEZB,I)
       AQ850A=AQ850A+C(I)*ASOL2(4,SEZA,I)
       AQ850B=AQ850B+C(I)*ASOL2(4,SEZB,I)  
C       
       BQ350A=BQ350A+C(I)*BSOL2(1,SEZA,I)
       BQ350B=BQ350B+C(I)*BSOL2(1,SEZB,I)
       BQ430A=BQ430A+C(I)*BSOL2(2,SEZA,I)
       BQ430B=BQ430B+C(I)*BSOL2(2,SEZB,I)
       BQ600A=BQ600A+C(I)*BSOL2(3,SEZA,I)
       BQ600B=BQ600B+C(I)*BSOL2(3,SEZB,I)
       BQ850A=BQ850A+C(I)*BSOL2(4,SEZA,I)
       BQ850B=BQ850B+C(I)*BSOL2(4,SEZB,I)
C       
       CQ350A=CQ350A+C(I)*CSOL2(1,SEZA,I)
       CQ350B=CQ350B+C(I)*CSOL2(1,SEZB,I)
       CQ430A=CQ430A+C(I)*CSOL2(2,SEZA,I)
       CQ430B=CQ430B+C(I)*CSOL2(2,SEZB,I)
       CQ600A=CQ600A+C(I)*CSOL2(3,SEZA,I)
       CQ600B=CQ600B+C(I)*CSOL2(3,SEZB,I)
       CQ850A=CQ850A+C(I)*CSOL2(4,SEZA,I)
30     CQ850B=CQ850B+C(I)*CSOL2(4,SEZB,I)       
C
       TP350A=AL350A*PF107+BL350A
       TP350B=AL350B*PF107+BL350B
       TP430A=AL430A*PF107+BL430A
       TP430B=AL430B*PF107+BL430B
      IF (PF107 .LE. 200) THEN
       TP600A=AL600A*PF107+BL600A+AQ600A*PF107**2+BQ600A*PF107+CQ600A
       TP600B=AL600B*PF107+BL600B+AQ600B*PF107**2+BQ600B*PF107+CQ600B
       TP850A=AL850A*PF107+BL850A+AQ850A*PF107**2+BQ850A*PF107+CQ850A
       TP850B=AL850B*PF107+BL850B+AQ850B*PF107**2+BQ850B*PF107+CQ850B
      ELSE    
       TP600A=(2*(AL600A*PF107+BL600A)+
     &         AQ600A*PF107**2+BQ600A*PF107+CQ600A)/2.0
       TP600B=(2*(AL600B*PF107+BL600B)+
     &         AQ600B*PF107**2+BQ600B*PF107+CQ600B)/2.0
       TP850A=(2*(AL850A*PF107+BL850A)+
     &        AQ850A*PF107**2+BQ850A*PF107+CQ850A)/2.0
       TP850B=(2*(AL850B*PF107+BL850B)+
     &        AQ850B*PF107**2+BQ850B*PF107+CQ850B)/2.0
      END IF
      IF (ABS(INVDP) .GT. 60.) THEN
       TP600A=AL600A*PF107+BL600A
       TP600B=AL600B*PF107+BL600B
      END IF  
      RETURN
      END
      